\documentclass[letterpaper,12pt]{article}
\usepackage{amsmath, amssymb, geometry, titlesec, esint}
\geometry{margin=1in}

%Make section titles smaller
\titleformat{\section}
    {\large\bfseries}
    {\thesection.}{0.5em}{}

\titleformat{\subsection}
    {\normalsize\bfseries}
    {\thesubsection.}{0.5em}{}

%Customize vertical spacing
\titlespacing*{\section}{0pt}{12pt}{6pt}
\titlespacing*{\subsection}{0pt}{10pt}{4pt}

\setlength{\parindent}{0pt} % no indentation

\begin{document}

%---------------------------------------------------------------------------------------------------------------

%INFO

Christian DiPietrantonio \\
ME M311: Computational Methods to Viscous Flows \\
\today

\vspace{10pt}

%---------------------------------------------------------------------------------------------------------------

%TITLE
{\large \textbf{Computer Assignment 01:} \normalsize Numerical and Analytical Solutions to Parabolic Partial Differential Equations: prerequisite for solving boundary layer problems}

%---------------------------------------------------------------------------------------------------------------

%DESCRIPTION OF THE PROBLEM
\section{Description of the Problem:}

Given the following second order linear parabolic partial differential equation (PDE):

\begin{equation}
\frac{\partial u}{\partial x} - 2 \frac{\partial^2 u}{\partial y^2} = 2
\end{equation}

With boundary conditions: $u\left(x,0\right) = 0$, $u\left(x,1\right) = 0$, and initial condition: $u(0,y) = 0$, our objectives were to:
\begin{enumerate}
    \item Derive the analytical solution of the parabolic equation with its given initial and boundary conditions.
    \item Use the Crank-Nicolson scheme and central difference scheme to discretize the equation (using either a finite-volume or a finite-difference based method).
    \item Find the numerical solution of the parabolic equation and compare it with the analytical solution using LU decomposition as the linear system solver.
\end{enumerate}

The results of these objectives will be of use for further projects, as parabolic partial differential equations like the one above can be used to describe heat conduction and viscous boundary layers.

%---------------------------------------------------------------------------------------------------------------

%DERIVATION OF THE ANALYTICAL SOLUTION
\section{Derivation of the Analytical Solution:}

As mentioned in the supplemental materials, the equation $\frac{\partial u}{\partial x} - 2 \frac{\partial^2 u}{\partial y^2} = 2$ is inhomogenous, therefore to solve it one must use superposition in addition to the conventional separation of variables technique. The solution, $u$ is expressed as $u(x,y) = v(x,y) + f(y)$, and the original equation is re-written as:

\begin{equation}
\frac{\partial v}{\partial x} - 2 \frac{\partial^2 v}{\partial y^2} - 2 \frac{\partial^2 f}{\partial y^2} = 2
\end{equation}

By setting $\frac{\partial^2 f}{\partial y^2} = -1 $, the equation above can be re-written as:

\begin{equation}
\frac{\partial v}{\partial x} - 2 \frac{\partial^2 v}{\partial y^2} = 0
\end{equation}

The separation of variables technique can now be used to solve the equation above. To start, one can assume that $v(x,y) = X(x)Y(y)$, therefore:

\begin{equation}
X'(x)Y(y) - 2X(x)Y''(y) = 0
\end{equation}

Dividing both sides by $X(x)Y(y)$, and rearranging gives:

\begin{equation}
\frac{X'(x)}{X(x)} = 2 \frac{Y''(y)}{Y(y)} = -\lambda
\end{equation}

The equation above can then be separated into two ordinary differential equations:

\begin{equation}
X'(x) + \lambda X(x) = 0
\end{equation}
\begin{equation}
Y''(y) + \frac{\lambda}{2} Y(y) = 0
\end{equation}

From $u(x,0) = 0$, $f(0) = 0$ and $v(x,0) = 0$. From $u(x,1) = 0$, $f(1) = 0$ and $v(x,1) = 0$. Finally, from $u(0,y) = 0$, $v(0,y) = -f(y)$. Therefore, the boundary conditions for $Y(y)$ are $Y(0) = 0$ and $Y(1) = 0$. Now, define $ \alpha ^2 = \frac{\lambda}{2}$, therefore the equation for $Y(y)$ can be re-written as:

\begin{equation}
Y''(y) + \alpha^2 Y(y) = 0
\end{equation}

The general solution to which is:

\begin{equation}
Y(y) = A \cos(\alpha y) + B \sin(\alpha y) 
\end{equation}

Applying the boundary condition $Y(0) = 0$ gives $A = 0$. Therefore, $Y(y) = B \sin(\alpha y)$. Applying the boundary condition $Y(1) = 0$ gives $Y(1) = B \sin(\alpha) = 0$. For a non-trivial solution, we need:

\begin{equation}
\sin(\alpha) = 0 \implies \alpha = n \pi, \quad n = 1, 2, 3, ...
\end{equation}

Therefore:

\begin{equation}
Y_n(y) = B_n \sin(n \pi y)
\end{equation}

Recall that $\alpha^2 = \frac{\lambda}{2}$, therefore $\lambda_n = 2 (n \pi)^2$. Thus, we can write:

\begin{equation}
X'(x) + 2 (n \pi)^2 X(x) = 0
\end{equation}

The general solution to which is:

\begin{equation}
X_n(x) = A_n e^{-2 (n \pi)^2 x}
\end{equation}

Therefore, the solution to the homogenous equation is:

\begin{equation}
v(x,y) = \sum_{n=1}^{\infty} A_n e^{-2 (n \pi)^2 x} \sin(n \pi y)
\end{equation}

From $\frac{\partial^2 f}{\partial y^2} = -1 $ and the boundary conditions $f(0) = 0$ and $f(1) = 0$, $f(y) = \frac{y}{2} \left(1 - y\right)$. Again, at $u(0, y) = 0$, $v(0, y) = -f(y)$. Therefore:

\begin{equation}
\sum_{n=1}^{\infty} A_n \sin(n \pi y) = -\frac{y}{2} \left(1 - y\right)
\end{equation}

We can regonize this as a Fourier sine series on the interval $[0, 1]$, therefore:

\begin{equation}
A_n = -2 \int_0^1 \frac{y}{2} (1-y) \sin(n \pi y) dy = - \int_0^1 y (1-y) \sin(n \pi y) dy
\end{equation}

Evaluating this integral gives:

\begin{equation}
A_n = \frac{2 \left((-1)^n - 1\right)}{\left(n \pi\right)^3}
\end{equation}

For even values of $n$, $A_n = 0$. For odd values of $n$, $A_n = -\frac{4}{\left(n \pi\right)^3}$. Thus, we have:

\begin{equation}
v(x,y) = \sum_{n=1,3,5,...}^{\infty} -\frac{4}{(n \pi)^3} e^{-2x (n \pi)^2} \sin(n \pi y)
\end{equation}

And finally, the the analytical solution of the parabolic equation can be expressed as:

\begin{equation}
\boxed{
u(x,y) = \sum_{n=1,3,5,...}^{\infty} -\frac{4}{(n \pi)^3} e^{-2x (n \pi)^2} \sin(n \pi y) + \frac{y}{2} \left(1 - y\right)
}
\end{equation}

%---------------------------------------------------------------------------------------------------------------
%DESCRIPTION OF THE NUMERICAL METHOD
\section{Description of the Numerical Method:}

To discretize Equation 1, the entire equation is integrated over the specified $x$ interval, $\Delta x$, and the control volume, $V$:

\begin{equation}
\iiint\limits_{V} \left(\int_{x}^{x+\Delta x} \frac {\partial u}{\partial x}\, dx\right)\, dV = \int_{x}^{x+\Delta x} \left(\iiint\limits_{V} \left(2 \frac{\partial^2 u}{\partial y^2} + 2\right)\, dV\right)\, dx
\end{equation}

For the left-hand side, integrating over x gives:

\begin{equation}
\iiint\limits_{V} \left(u(x + \Delta x) - u(x)\right)\, dV = \left(u(x + \Delta x) - u(x)\right) \Delta y = \Delta y \left({u_{i}}^{n+1} - {u_{i}}^{n}\right)
\end{equation}

On the right-hand side, the divergence theorem is used to convert the integral over the control volume into a surface integral:

\begin{equation}
\oiint\limits_{A}\left(2 \frac{\partial u}{\partial y} \hat{n}_{y}\right)\, dA + 2 \Delta y 
\end{equation}

After evaluating the surface integral, the derivative is discretized using a central-difference scheme:

\begin{equation}
2\left( \frac{u_{i+1} - u_{i}}{\Delta y}\right) - 2 \left(\frac{u_{i} - u_{i-1}}{\Delta y}\right) + 2 \Delta y 
\end{equation}

Thus, the right-hand side reduces to:

\begin{equation}
\int_{x}^{x + \Delta x} \left(2\left( \frac{u_{i+1} - u_{i}}{\Delta y}\right) - 2 \left(\frac{u_{i} - u_{i-1}}{\Delta y}\right) + 2 \Delta y\right)\, dx
\end{equation}

Next, the integration $\int_x^{x + \Delta x} u\, dx$ is approximated using:

\begin{equation}
\int_x^{x + \Delta x} u dx = \left(\theta u^n + (1 - \theta) u^{n+1}\right) \Delta x
\end{equation}

For the Crank-Nicholson scheme ($\theta = 0.5$), Equation 24 becomes:

\begin{equation}
\frac{\Delta x}{\Delta y} \left( \left({u_{i+1}}^{n} + {u_{i+1}}^{n+1}\right) - 2\left({u_{i}}^{n} + {u_{i}}^{n+1}\right) + \left({u_{i-1}}^{n} + {u_{i-1}}^{n+1}\right)\right) + 2 \Delta y \Delta x
\end{equation}

Finally, by equating the left and right-hand sides and dividing both by $\Delta y$, the following discretized governing equation is obtained:
\begin{equation}
\boxed{ 
{u_{i}}^{n+1} - {u_{i}}^{n} = \frac{\Delta x}{\Delta y^2} \left( \left({u_{i+1}}^{n} + {u_{i+1}}^{n+1}\right) - 2\left({u_{i}}^{n} + {u_{i}}^{n+1}\right) + \left({u_{i-1}}^{n} + {u_{i-1}}^{n+1}\right)\right) + 2 \Delta x
}
\end{equation}

We can now program a numerical solver (using LU decomposition as the linear system solver) to solve the discretized governing equation above, and compare the results with the analytical solution derived in the previous section. 

%---------------------------------------------------------------------------------------------------------------

%PRESENTATION OF RESULTS
\section{Presentation of Results:}

\subsection{Profiles at different x locations from numerical solution}

TBD

\subsection{Profiles at different x locations from analytical solution}

TBD

%---------------------------------------------------------------------------------------------------------------

%DISCUSSION OF RESULTS
\section{Discussion of Results:}

\subsection{General description}

TBD

\subsection{Accuracy and stability}

TBD

%---------------------------------------------------------------------------------------------------------------

%APPENDIX - copy of program listing
\section{Appendix - Copy of Program Listing:}

\subsection{Structure}

TBD

\subsection{Documentation}

TBD

%---------------------------------------------------------------------------------------------------------------

\end{document}
